{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\harsh2\\\\CSE\\\\React Development\\\\firebase_project\\\\src\\\\pages\\\\main\\\\posts.tsx\",\n  _s = $RefreshSig$();\nimport { addDoc, collection, getDocs, query, where } from \"firebase/firestore\";\nimport { db, auth } from \"../../config/firebase\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const Post = props => {\n  _s();\n  const {\n    post\n  } = props;\n  const [user] = useAuthState(auth);\n  const [likes, setLike] = useState(null);\n  const likesRef = collection(db, \"likes\");\n  const likesDoc = query(likesRef, where(\"postId\", \"==\", post.id));\n  const hasLiked = likes === null || likes === void 0 ? void 0 : likes.find(like => like.userId === (user === null || user === void 0 ? void 0 : user.uid));\n  const getLikes = async () => {\n    const data = await getDocs(likesDoc);\n    setLike(data.docs.map(doc => ({\n      userId: doc.data().userId\n    })));\n  };\n  const addLike = async () => {\n    try {\n      await addDoc(likesRef, {\n        userId: user === null || user === void 0 ? void 0 : user.uid,\n        postId: post.id\n      });\n      if (user) {\n        setLike(prev => prev ? [...prev, {\n          userId: user === null || user === void 0 ? void 0 : user.uid\n        }] : [{\n          userId: user.uid\n        }]);\n      }\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  useEffect(() => {\n    getLikes();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"title\",\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: post.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"body\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: post.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"footer\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"@\", post.username]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: addLike,\n        children: hasLiked ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: \"\\uD83D\\uDC4E\"\n        }, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: \"\\uD83D\\uDC4D\"\n        }, void 0, false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Likes: \", likes === null || likes === void 0 ? void 0 : likes.length]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 54,\n    columnNumber: 9\n  }, this);\n};\n_s(Post, \"TPmIkFi/O/cdrZcG5rfbJj7/pNA=\", false, function () {\n  return [useAuthState];\n});\n_c = Post;\nvar _c;\n$RefreshReg$(_c, \"Post\");","map":{"version":3,"names":["addDoc","collection","getDocs","query","where","db","auth","useAuthState","useEffect","useState","jsxDEV","_jsxDEV","Fragment","_Fragment","Post","props","_s","post","user","likes","setLike","likesRef","likesDoc","id","hasLiked","find","like","userId","uid","getLikes","data","docs","map","doc","addLike","postId","prev","err","console","log","children","className","title","fileName","_jsxFileName","lineNumber","columnNumber","description","username","onClick","length","_c","$RefreshReg$"],"sources":["C:/Users/ASUS/Desktop/harsh2/CSE/React Development/firebase_project/src/pages/main/posts.tsx"],"sourcesContent":["import { Post as IPost} from \"./main\"\r\nimport { addDoc, collection, getDocs, query, where } from \"firebase/firestore\";\r\nimport { db, auth } from \"../../config/firebase\";\r\nimport { FirebaseError } from \"firebase/app\";\r\nimport { AuthStateHook, useAuthState } from \"react-firebase-hooks/auth\";\r\nimport { useEffect, useState } from \"react\";\r\n\r\n\r\ninterface Props {\r\n    post: IPost;\r\n}\r\n\r\ninterface Like {\r\n    userId: string;\r\n}\r\n\r\nexport const Post = (props: Props) => {\r\n\r\n    const {post} = props;\r\n    const [user] = useAuthState(auth);\r\n    \r\n    const [likes, setLike] = useState<Like[] | null>(null);\r\n    const likesRef = collection(db, \"likes\");\r\n\r\n    const likesDoc = query (likesRef, where(\"postId\", \"==\", post.id));\r\n\r\n    const hasLiked = likes?.find((like) => like.userId === user?.uid)\r\n    const getLikes = async () => {\r\n        const data = await getDocs(likesDoc);\r\n        setLike(data.docs.map((doc) => ({ userId: doc.data().userId})));\r\n    }\r\n\r\n    const addLike = async () => {\r\n        try {\r\n            await addDoc(likesRef, {\r\n                userId: user?.uid,\r\n                postId: post.id,\r\n            });\r\n            if (user) {\r\n                setLike((prev) => prev ? [...prev, {userId: user?.uid}] : [{ userId: user.uid}]);\r\n            }\r\n        } catch (err) {\r\n            console.log(err);\r\n        }\r\n        \r\n    }\r\n\r\n\r\n    useEffect(() => {\r\n        getLikes();\r\n    }, []);\r\n\r\n    return (\r\n        <div>\r\n            <div className=\"title\">\r\n                <h1>{post.title}</h1>\r\n            </div>\r\n            <div className=\"body\">\r\n                <p>{post.description}</p>\r\n            </div>\r\n            <div className=\"footer\">\r\n                <p>@{post.username}</p>\r\n                <button onClick={addLike}>{hasLiked ? <>&#128078;</> : <>&#128077;</>}</button>\r\n                <p>Likes: {likes?.length}</p>\r\n            </div>\r\n\r\n        </div>\r\n    )   \r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}